; Listing generated by Microsoft (R) Optimizing Compiler Version 19.27.29112.0 

	TITLE	C:\DS Project\DS Files\Source\ClientSource\Client\EterBase\Random.cpp
	.686P
	.XMM
	include listing.inc
	.model	flat

INCLUDELIB LIBCMT
INCLUDELIB OLDNAMES

PUBLIC	?srandom@@YAXK@Z				; srandom
PUBLIC	?random@@YAKXZ					; random
PUBLIC	?frandom@@YAMMM@Z				; frandom
PUBLIC	?random_range@@YAJJJ@Z				; random_range
PUBLIC	__real@30000000
PUBLIC	__xmm@41f00000000000000000000000000000
EXTRN	__fltused:DWORD
;	COMDAT __xmm@41f00000000000000000000000000000
CONST	SEGMENT
__xmm@41f00000000000000000000000000000 DB 00H, 00H, 00H, 00H, 00H, 00H, 00H
	DB	00H, 00H, 00H, 00H, 00H, 00H, 00H, 0f0H, 'A'
CONST	ENDS
;	COMDAT __real@30000000
CONST	SEGMENT
__real@30000000 DD 030000000r			; 4.65661e-10
CONST	ENDS
_DATA	SEGMENT
?randseed@@3KA DD 01H					; randseed
_DATA	ENDS
; Function compile flags: /Ogtp
; File C:\DS Project\DS Files\Source\ClientSource\Client\EterBase\Random.cpp
;	COMDAT ?random_range@@YAJJJ@Z
_TEXT	SEGMENT
_from$ = 8						; size = 4
_to$ = 12						; size = 4
?random_range@@YAJJJ@Z PROC				; random_range, COMDAT

; 45   : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp

; 46   : 	assert(from <= to);
; 47   : 	return ((random() % (to - from + 1)) + from);

  00003	e8 00 00 00 00	 call	 ?random@@YAKXZ		; random
  00008	8b 4d 0c	 mov	 ecx, DWORD PTR _to$[ebp]
  0000b	33 d2		 xor	 edx, edx
  0000d	2b 4d 08	 sub	 ecx, DWORD PTR _from$[ebp]
  00010	41		 inc	 ecx
  00011	f7 f1		 div	 ecx
  00013	03 55 08	 add	 edx, DWORD PTR _from$[ebp]
  00016	8b c2		 mov	 eax, edx

; 48   : }

  00018	5d		 pop	 ebp
  00019	c3		 ret	 0
?random_range@@YAJJJ@Z ENDP				; random_range
_TEXT	ENDS
; Function compile flags: /Ogtp
; File C:\DS Project\DS Files\Source\ClientSource\Client\EterBase\Random.cpp
;	COMDAT ?frandom@@YAMMM@Z
_TEXT	SEGMENT
_flLow$ = 8						; size = 4
tv78 = 12						; size = 4
_flHigh$ = 12						; size = 4
?frandom@@YAMMM@Z PROC					; frandom, COMDAT

; 39   : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp

; 40   : 	float fl = float(random()) / float(2147483648.0f); // float in [0,1)

  00003	e8 00 00 00 00	 call	 ?random@@YAKXZ		; random
  00008	66 0f 6e c0	 movd	 xmm0, eax
  0000c	f3 0f e6 c0	 cvtdq2pd xmm0, xmm0
  00010	c1 e8 1f	 shr	 eax, 31			; 0000001fH
  00013	f2 0f 58 04 c5
	00 00 00 00	 addsd	 xmm0, QWORD PTR __xmm@41f00000000000000000000000000000[eax*8]
  0001c	66 0f 5a d0	 cvtpd2ps xmm2, xmm0

; 41   : 	return (fl * (flHigh - flLow)) + flLow; // float in [low,high)

  00020	f3 0f 10 45 0c	 movss	 xmm0, DWORD PTR _flHigh$[ebp]
  00025	f3 0f 59 15 00
	00 00 00	 mulss	 xmm2, DWORD PTR __real@30000000
  0002d	f3 0f 5c 45 08	 subss	 xmm0, DWORD PTR _flLow$[ebp]
  00032	f3 0f 59 d0	 mulss	 xmm2, xmm0
  00036	f3 0f 58 55 08	 addss	 xmm2, DWORD PTR _flLow$[ebp]
  0003b	f3 0f 11 55 0c	 movss	 DWORD PTR tv78[ebp], xmm2
  00040	d9 45 0c	 fld	 DWORD PTR tv78[ebp]

; 42   : }

  00043	5d		 pop	 ebp
  00044	c3		 ret	 0
?frandom@@YAMMM@Z ENDP					; frandom
_TEXT	ENDS
; Function compile flags: /Ogtp
; File C:\DS Project\DS Files\Source\ClientSource\Client\EterBase\Random.cpp
;	COMDAT ?random@@YAKXZ
_TEXT	SEGMENT
?random@@YAKXZ PROC					; random, COMDAT

; 19   : 	register long x, hi, lo, t;
; 20   : 
; 21   : 	/*
; 22   : 	* Compute x[n + 1] = (7^5 * x[n]) mod (2^31 - 1).
; 23   : 	* From "Random number generators: good ones are hard to find",
; 24   : 	* Park and Miller, Communications of the ACM, vol. 31, no. 10,
; 25   : 	* October 1988, p. 1195.
; 26   : 	*/
; 27   : 	x = randseed;
; 28   : 	hi = x / 127773;

  00000	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?randseed@@3KA
  00006	b8 5f 0b 4e 83	 mov	 eax, -2092037281	; 834e0b5fH
  0000b	f7 e9		 imul	 ecx
  0000d	03 d1		 add	 edx, ecx
  0000f	69 c9 a7 41 00
	00		 imul	 ecx, ecx, 16807
  00015	c1 fa 10	 sar	 edx, 16			; 00000010H
  00018	8b c2		 mov	 eax, edx
  0001a	c1 e8 1f	 shr	 eax, 31			; 0000001fH
  0001d	03 c2		 add	 eax, edx

; 29   : 	lo = x % 127773;
; 30   : 	t = 16807 * lo - 2836 * hi;

  0001f	69 c0 ff ff ff
	7f		 imul	 eax, eax, 2147483647
  00025	2b c8		 sub	 ecx, eax

; 31   : 	if (t <= 0)
; 32   : 		t += 0x7fffffff;
; 33   : 	randseed = t;

  00027	85 c9		 test	 ecx, ecx
  00029	8d 81 ff ff ff
	7f		 lea	 eax, DWORD PTR [ecx+2147483647]
  0002f	0f 4f c1	 cmovg	 eax, ecx
  00032	a3 00 00 00 00	 mov	 DWORD PTR ?randseed@@3KA, eax

; 34   : 	return (t);
; 35   : }

  00037	c3		 ret	 0
?random@@YAKXZ ENDP					; random
_TEXT	ENDS
; Function compile flags: /Ogtp
; File C:\DS Project\DS Files\Source\ClientSource\Client\EterBase\Random.cpp
;	COMDAT ?srandom@@YAXK@Z
_TEXT	SEGMENT
_seed$ = 8						; size = 4
?srandom@@YAXK@Z PROC					; srandom, COMDAT

; 8    : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp

; 9    : 	randseed = seed;

  00003	8b 45 08	 mov	 eax, DWORD PTR _seed$[ebp]
  00006	a3 00 00 00 00	 mov	 DWORD PTR ?randseed@@3KA, eax

; 10   : }

  0000b	5d		 pop	 ebp
  0000c	c3		 ret	 0
?srandom@@YAXK@Z ENDP					; srandom
_TEXT	ENDS
END
