; Listing generated by Microsoft (R) Optimizing Compiler Version 19.27.29112.0 

	TITLE	C:\DS Project\DS Files\Source\ClientSource\Client\GameLib\TerrainPatch.cpp
	.686P
	.XMM
	include listing.inc
	.model	flat

INCLUDELIB LIBCMT
INCLUDELIB OLDNAMES

PUBLIC	?SOFTWARE_TRANSFORM_PATCH_ENABLE@CTerrainPatch@@2_NA ; CTerrainPatch::SOFTWARE_TRANSFORM_PATCH_ENABLE
_DATA	SEGMENT
?SOFTWARE_TRANSFORM_PATCH_ENABLE@CTerrainPatch@@2_NA DB 01H ; CTerrainPatch::SOFTWARE_TRANSFORM_PATCH_ENABLE
_DATA	ENDS
PUBLIC	??_H@YGXPAXIIP6EPAX0@Z@Z			; `vector constructor iterator'
PUBLIC	??0SoftwareTransformPatch_SSourceVertex@@QAE@XZ	; SoftwareTransformPatch_SSourceVertex::SoftwareTransformPatch_SSourceVertex
PUBLIC	?Clear@CTerrainPatch@@QAEXXZ			; CTerrainPatch::Clear
PUBLIC	?GetWaterFaceCount@CTerrainPatch@@QAEIXZ	; CTerrainPatch::GetWaterFaceCount
PUBLIC	?SoftwareTransformPatch_UpdateTerrainLighting@CTerrainPatch@@QAEXKABU_D3DLIGHT8@@ABU_D3DMATERIAL8@@@Z ; CTerrainPatch::SoftwareTransformPatch_UpdateTerrainLighting
PUBLIC	?BuildTerrainVertexBuffer@CTerrainPatch@@QAEXPAUHardwareTransformPatch_SSourceVertex@@@Z ; CTerrainPatch::BuildTerrainVertexBuffer
PUBLIC	?BuildWaterVertexBuffer@CTerrainPatch@@QAEXPAUSWaterVertex@@I@Z ; CTerrainPatch::BuildWaterVertexBuffer
PUBLIC	?__BuildHardwareTerrainVertexBuffer@CTerrainPatch@@IAEXPAUHardwareTransformPatch_SSourceVertex@@@Z ; CTerrainPatch::__BuildHardwareTerrainVertexBuffer
PUBLIC	?__BuildSoftwareTerrainVertexBuffer@CTerrainPatch@@IAEXPAUHardwareTransformPatch_SSourceVertex@@@Z ; CTerrainPatch::__BuildSoftwareTerrainVertexBuffer
PUBLIC	??0SSoftwareTransformPatch@CTerrainPatch@@QAE@XZ ; CTerrainPatch::SSoftwareTransformPatch::SSoftwareTransformPatch
PUBLIC	??1SSoftwareTransformPatch@CTerrainPatch@@QAE@XZ ; CTerrainPatch::SSoftwareTransformPatch::~SSoftwareTransformPatch
PUBLIC	?Create@SSoftwareTransformPatch@CTerrainPatch@@QAEXXZ ; CTerrainPatch::SSoftwareTransformPatch::Create
PUBLIC	?Destroy@SSoftwareTransformPatch@CTerrainPatch@@QAEXXZ ; CTerrainPatch::SSoftwareTransformPatch::Destroy
PUBLIC	?__Initialize@SSoftwareTransformPatch@CTerrainPatch@@QAEXXZ ; CTerrainPatch::SSoftwareTransformPatch::__Initialize
PUBLIC	??0CTerrainPatchProxy@@QAE@XZ			; CTerrainPatchProxy::CTerrainPatchProxy
PUBLIC	??1CTerrainPatchProxy@@UAE@XZ			; CTerrainPatchProxy::~CTerrainPatchProxy
PUBLIC	?Clear@CTerrainPatchProxy@@QAEXXZ		; CTerrainPatchProxy::Clear
PUBLIC	?SetCenterPosition@CTerrainPatchProxy@@QAEXABUD3DXVECTOR3@@@Z ; CTerrainPatchProxy::SetCenterPosition
PUBLIC	?IsIn@CTerrainPatchProxy@@QAE_NABUD3DXVECTOR3@@M@Z ; CTerrainPatchProxy::IsIn
PUBLIC	?GetWaterFaceCount@CTerrainPatchProxy@@QAEIXZ	; CTerrainPatchProxy::GetWaterFaceCount
PUBLIC	?SoftwareTransformPatch_GetTerrainVertexDataPtr@CTerrainPatchProxy@@QAEPAUSoftwareTransformPatch_SSourceVertex@@XZ ; CTerrainPatchProxy::SoftwareTransformPatch_GetTerrainVertexDataPtr
PUBLIC	?HardwareTransformPatch_GetVertexBufferPtr@CTerrainPatchProxy@@QAEPAVCGraphicVertexBuffer@@XZ ; CTerrainPatchProxy::HardwareTransformPatch_GetVertexBufferPtr
PUBLIC	?SoftwareTransformPatch_UpdateTerrainLighting@CTerrainPatchProxy@@QAEXKABU_D3DLIGHT8@@ABU_D3DMATERIAL8@@@Z ; CTerrainPatchProxy::SoftwareTransformPatch_UpdateTerrainLighting
PUBLIC	??_GCTerrainPatchProxy@@UAEPAXI@Z		; CTerrainPatchProxy::`scalar deleting destructor'
PUBLIC	??_7CTerrainPatchProxy@@6B@			; CTerrainPatchProxy::`vftable'
PUBLIC	??_R4CTerrainPatchProxy@@6B@			; CTerrainPatchProxy::`RTTI Complete Object Locator'
PUBLIC	??_R0?AVCTerrainPatchProxy@@@8			; CTerrainPatchProxy `RTTI Type Descriptor'
PUBLIC	??_R3CTerrainPatchProxy@@8			; CTerrainPatchProxy::`RTTI Class Hierarchy Descriptor'
PUBLIC	??_R2CTerrainPatchProxy@@8			; CTerrainPatchProxy::`RTTI Base Class Array'
PUBLIC	??_R1A@?0A@EA@CTerrainPatchProxy@@8		; CTerrainPatchProxy::`RTTI Base Class Descriptor at (0,-1,0,64)'
PUBLIC	__real@437f0000
PUBLIC	__real@4b7fffff
PUBLIC	__xmm@80000000800000008000000080000000
EXTRN	??3@YAXPAXI@Z:PROC				; operator delete
EXTRN	??_U@YAPAXI@Z:PROC				; operator new[]
EXTRN	??_V@YAXPAX@Z:PROC				; operator delete[]
EXTRN	?Destroy@CGraphicVertexBuffer@@QAEXXZ:PROC	; CGraphicVertexBuffer::Destroy
EXTRN	?Unlock@CGraphicVertexBuffer@@QAE_NXZ:PROC	; CGraphicVertexBuffer::Unlock
EXTRN	??_ECTerrainPatchProxy@@UAEPAXI@Z:PROC		; CTerrainPatchProxy::`vector deleting destructor'
EXTRN	__ftoui3:PROC
EXTRN	_memcpy:PROC
EXTRN	??_7type_info@@6B@:QWORD			; type_info::`vftable'
EXTRN	__fltused:DWORD
;	COMDAT __xmm@80000000800000008000000080000000
CONST	SEGMENT
__xmm@80000000800000008000000080000000 DB 00H, 00H, 00H, 080H, 00H, 00H, 00H
	DB	080H, 00H, 00H, 00H, 080H, 00H, 00H, 00H, 080H
CONST	ENDS
;	COMDAT __real@4b7fffff
CONST	SEGMENT
__real@4b7fffff DD 04b7fffffr			; 1.67772e+07
CONST	ENDS
;	COMDAT __real@437f0000
CONST	SEGMENT
__real@437f0000 DD 0437f0000r			; 255
CONST	ENDS
;	COMDAT ??_R1A@?0A@EA@CTerrainPatchProxy@@8
rdata$r	SEGMENT
??_R1A@?0A@EA@CTerrainPatchProxy@@8 DD FLAT:??_R0?AVCTerrainPatchProxy@@@8 ; CTerrainPatchProxy::`RTTI Base Class Descriptor at (0,-1,0,64)'
	DD	00H
	DD	00H
	DD	0ffffffffH
	DD	00H
	DD	040H
	DD	FLAT:??_R3CTerrainPatchProxy@@8
rdata$r	ENDS
;	COMDAT ??_R2CTerrainPatchProxy@@8
rdata$r	SEGMENT
??_R2CTerrainPatchProxy@@8 DD FLAT:??_R1A@?0A@EA@CTerrainPatchProxy@@8 ; CTerrainPatchProxy::`RTTI Base Class Array'
rdata$r	ENDS
;	COMDAT ??_R3CTerrainPatchProxy@@8
rdata$r	SEGMENT
??_R3CTerrainPatchProxy@@8 DD 00H			; CTerrainPatchProxy::`RTTI Class Hierarchy Descriptor'
	DD	00H
	DD	01H
	DD	FLAT:??_R2CTerrainPatchProxy@@8
rdata$r	ENDS
;	COMDAT ??_R0?AVCTerrainPatchProxy@@@8
data$r	SEGMENT
??_R0?AVCTerrainPatchProxy@@@8 DD FLAT:??_7type_info@@6B@ ; CTerrainPatchProxy `RTTI Type Descriptor'
	DD	00H
	DB	'.?AVCTerrainPatchProxy@@', 00H
data$r	ENDS
;	COMDAT ??_R4CTerrainPatchProxy@@6B@
rdata$r	SEGMENT
??_R4CTerrainPatchProxy@@6B@ DD 00H			; CTerrainPatchProxy::`RTTI Complete Object Locator'
	DD	00H
	DD	00H
	DD	FLAT:??_R0?AVCTerrainPatchProxy@@@8
	DD	FLAT:??_R3CTerrainPatchProxy@@8
rdata$r	ENDS
;	COMDAT ??_7CTerrainPatchProxy@@6B@
CONST	SEGMENT
??_7CTerrainPatchProxy@@6B@ DD FLAT:??_R4CTerrainPatchProxy@@6B@ ; CTerrainPatchProxy::`vftable'
	DD	FLAT:??_ECTerrainPatchProxy@@UAEPAXI@Z
CONST	ENDS
; Function compile flags: /Ogtp
;	COMDAT ??_GCTerrainPatchProxy@@UAEPAXI@Z
_TEXT	SEGMENT
___flags$ = 8						; size = 4
??_GCTerrainPatchProxy@@UAEPAXI@Z PROC			; CTerrainPatchProxy::`scalar deleting destructor', COMDAT
; _this$ = ecx
  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	56		 push	 esi
  00004	8b f1		 mov	 esi, ecx
  00006	e8 00 00 00 00	 call	 ??1CTerrainPatchProxy@@UAE@XZ ; CTerrainPatchProxy::~CTerrainPatchProxy
  0000b	f6 45 08 01	 test	 BYTE PTR ___flags$[ebp], 1
  0000f	74 0b		 je	 SHORT $LN4@scalar
  00011	6a 1c		 push	 28			; 0000001cH
  00013	56		 push	 esi
  00014	e8 00 00 00 00	 call	 ??3@YAXPAXI@Z		; operator delete
  00019	83 c4 08	 add	 esp, 8
$LN4@scalar:
  0001c	8b c6		 mov	 eax, esi
  0001e	5e		 pop	 esi
  0001f	5d		 pop	 ebp
  00020	c2 04 00	 ret	 4
??_GCTerrainPatchProxy@@UAEPAXI@Z ENDP			; CTerrainPatchProxy::`scalar deleting destructor'
_TEXT	ENDS
; Function compile flags: /Ogtp
; File C:\DS Project\DS Files\Source\ClientSource\Client\GameLib\TerrainPatch.cpp
;	COMDAT ?SoftwareTransformPatch_UpdateTerrainLighting@CTerrainPatchProxy@@QAEXKABU_D3DLIGHT8@@ABU_D3DMATERIAL8@@@Z
_TEXT	SEGMENT
_dwVersion$ = 8						; size = 4
_c_rkLight$ = 12					; size = 4
_c_rkMtrl$ = 16						; size = 4
?SoftwareTransformPatch_UpdateTerrainLighting@CTerrainPatchProxy@@QAEXKABU_D3DLIGHT8@@ABU_D3DMATERIAL8@@@Z PROC ; CTerrainPatchProxy::SoftwareTransformPatch_UpdateTerrainLighting, COMDAT
; _this$ = ecx

; 204  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp

; 205  : 	if (m_pTerrainPatch)

  00003	8b 49 0c	 mov	 ecx, DWORD PTR [ecx+12]
  00006	85 c9		 test	 ecx, ecx
  00008	74 06		 je	 SHORT $LN2@SoftwareTr

; 207  : }

  0000a	5d		 pop	 ebp

; 206  : 		m_pTerrainPatch->SoftwareTransformPatch_UpdateTerrainLighting(dwVersion, c_rkLight, c_rkMtrl);

  0000b	e9 00 00 00 00	 jmp	 ?SoftwareTransformPatch_UpdateTerrainLighting@CTerrainPatch@@QAEXKABU_D3DLIGHT8@@ABU_D3DMATERIAL8@@@Z ; CTerrainPatch::SoftwareTransformPatch_UpdateTerrainLighting
$LN2@SoftwareTr:

; 207  : }

  00010	5d		 pop	 ebp
  00011	c2 0c 00	 ret	 12			; 0000000cH
?SoftwareTransformPatch_UpdateTerrainLighting@CTerrainPatchProxy@@QAEXKABU_D3DLIGHT8@@ABU_D3DMATERIAL8@@@Z ENDP ; CTerrainPatchProxy::SoftwareTransformPatch_UpdateTerrainLighting
_TEXT	ENDS
; Function compile flags: /Ogtp
; File C:\DS Project\DS Files\Source\ClientSource\Client\GameLib\TerrainPatch.cpp
;	COMDAT ?HardwareTransformPatch_GetVertexBufferPtr@CTerrainPatchProxy@@QAEPAVCGraphicVertexBuffer@@XZ
_TEXT	SEGMENT
?HardwareTransformPatch_GetVertexBufferPtr@CTerrainPatchProxy@@QAEPAVCGraphicVertexBuffer@@XZ PROC ; CTerrainPatchProxy::HardwareTransformPatch_GetVertexBufferPtr, COMDAT
; _this$ = ecx

; 211  : 	if (m_pTerrainPatch)

  00000	8b 41 0c	 mov	 eax, DWORD PTR [ecx+12]
  00003	85 c0		 test	 eax, eax
  00005	74 04		 je	 SHORT $LN2@HardwareTr

; 212  : 		return m_pTerrainPatch->HardwareTransformPatch_GetVertexBufferPtr();

  00007	83 c0 4c	 add	 eax, 76			; 0000004cH

; 215  : }

  0000a	c3		 ret	 0
$LN2@HardwareTr:

; 213  : 
; 214  : 	return NULL;

  0000b	33 c0		 xor	 eax, eax

; 215  : }

  0000d	c3		 ret	 0
?HardwareTransformPatch_GetVertexBufferPtr@CTerrainPatchProxy@@QAEPAVCGraphicVertexBuffer@@XZ ENDP ; CTerrainPatchProxy::HardwareTransformPatch_GetVertexBufferPtr
_TEXT	ENDS
; Function compile flags: /Ogtp
; File C:\DS Project\DS Files\Source\ClientSource\Client\GameLib\TerrainPatch.cpp
;	COMDAT ?SoftwareTransformPatch_GetTerrainVertexDataPtr@CTerrainPatchProxy@@QAEPAUSoftwareTransformPatch_SSourceVertex@@XZ
_TEXT	SEGMENT
?SoftwareTransformPatch_GetTerrainVertexDataPtr@CTerrainPatchProxy@@QAEPAUSoftwareTransformPatch_SSourceVertex@@XZ PROC ; CTerrainPatchProxy::SoftwareTransformPatch_GetTerrainVertexDataPtr, COMDAT
; _this$ = ecx

; 219  : 	if (m_pTerrainPatch)

  00000	8b 41 0c	 mov	 eax, DWORD PTR [ecx+12]
  00003	85 c0		 test	 eax, eax
  00005	74 04		 je	 SHORT $LN2@SoftwareTr

; 220  : 		return m_pTerrainPatch->SoftwareTransformPatch_GetTerrainVertexDataPtr();

  00007	8b 40 6c	 mov	 eax, DWORD PTR [eax+108]

; 223  : }

  0000a	c3		 ret	 0
$LN2@SoftwareTr:

; 221  : 
; 222  : 	return NULL;

  0000b	33 c0		 xor	 eax, eax

; 223  : }

  0000d	c3		 ret	 0
?SoftwareTransformPatch_GetTerrainVertexDataPtr@CTerrainPatchProxy@@QAEPAUSoftwareTransformPatch_SSourceVertex@@XZ ENDP ; CTerrainPatchProxy::SoftwareTransformPatch_GetTerrainVertexDataPtr
_TEXT	ENDS
; Function compile flags: /Ogtp
; File C:\DS Project\DS Files\Source\ClientSource\Client\GameLib\TerrainPatch.cpp
;	COMDAT ?GetWaterFaceCount@CTerrainPatchProxy@@QAEIXZ
_TEXT	SEGMENT
?GetWaterFaceCount@CTerrainPatchProxy@@QAEIXZ PROC	; CTerrainPatchProxy::GetWaterFaceCount, COMDAT
; _this$ = ecx

; 227  : 	if (m_pTerrainPatch)

  00000	8b 49 0c	 mov	 ecx, DWORD PTR [ecx+12]
  00003	85 c9		 test	 ecx, ecx
  00005	0f 85 00 00 00
	00		 jne	 ?GetWaterFaceCount@CTerrainPatch@@QAEIXZ ; CTerrainPatch::GetWaterFaceCount

; 228  : 		return m_pTerrainPatch->GetWaterFaceCount();
; 229  : 
; 230  : 	return 0;

  0000b	33 c0		 xor	 eax, eax

; 231  : }

  0000d	c3		 ret	 0
?GetWaterFaceCount@CTerrainPatchProxy@@QAEIXZ ENDP	; CTerrainPatchProxy::GetWaterFaceCount
_TEXT	ENDS
; Function compile flags: /Ogtp
; File C:\DS Project\DS Files\Source\ClientSource\Client\GameLib\TerrainPatch.cpp
;	COMDAT ?IsIn@CTerrainPatchProxy@@QAE_NABUD3DXVECTOR3@@M@Z
_TEXT	SEGMENT
_c_rv3Target$ = 8					; size = 4
_fRadius$ = 12						; size = 4
?IsIn@CTerrainPatchProxy@@QAE_NABUD3DXVECTOR3@@M@Z PROC	; CTerrainPatchProxy::IsIn, COMDAT
; _this$ = ecx

; 191  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp

; 192  : 	float dx=m_v3Center.x-c_rv3Target.x;

  00003	8b 45 08	 mov	 eax, DWORD PTR _c_rv3Target$[ebp]
  00006	f3 0f 10 41 10	 movss	 xmm0, DWORD PTR [ecx+16]

; 193  : 	float dy=m_v3Center.y-c_rv3Target.y;

  0000b	f3 0f 10 49 14	 movss	 xmm1, DWORD PTR [ecx+20]
  00010	f3 0f 5c 00	 subss	 xmm0, DWORD PTR [eax]
  00014	f3 0f 5c 48 04	 subss	 xmm1, DWORD PTR [eax+4]

; 194  : 	float fDist=dx*dx+dy*dy;

  00019	f3 0f 59 c0	 mulss	 xmm0, xmm0
  0001d	f3 0f 59 c9	 mulss	 xmm1, xmm1
  00021	f3 0f 58 c8	 addss	 xmm1, xmm0

; 195  : 	float fCheck=fRadius*fRadius;

  00025	f3 0f 10 45 0c	 movss	 xmm0, DWORD PTR _fRadius$[ebp]
  0002a	f3 0f 59 c0	 mulss	 xmm0, xmm0

; 196  : 
; 197  : 	if (fDist<fCheck)

  0002e	0f 2f c1	 comiss	 xmm0, xmm1
  00031	0f 97 c0	 seta	 al

; 198  : 		return true;
; 199  : 
; 200  : 	return false;
; 201  : }

  00034	5d		 pop	 ebp
  00035	c2 08 00	 ret	 8
?IsIn@CTerrainPatchProxy@@QAE_NABUD3DXVECTOR3@@M@Z ENDP	; CTerrainPatchProxy::IsIn
_TEXT	ENDS
; Function compile flags: /Ogtp
; File C:\DS Project\DS Files\Source\ClientSource\Client\GameLib\TerrainPatch.cpp
;	COMDAT ?SetCenterPosition@CTerrainPatchProxy@@QAEXABUD3DXVECTOR3@@@Z
_TEXT	SEGMENT
_c_rv3Center$ = 8					; size = 4
?SetCenterPosition@CTerrainPatchProxy@@QAEXABUD3DXVECTOR3@@@Z PROC ; CTerrainPatchProxy::SetCenterPosition, COMDAT
; _this$ = ecx

; 186  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp

; 187  : 	m_v3Center=c_rv3Center;

  00003	8b 45 08	 mov	 eax, DWORD PTR _c_rv3Center$[ebp]
  00006	f3 0f 7e 00	 movq	 xmm0, QWORD PTR [eax]
  0000a	66 0f d6 41 10	 movq	 QWORD PTR [ecx+16], xmm0
  0000f	8b 40 08	 mov	 eax, DWORD PTR [eax+8]
  00012	89 41 18	 mov	 DWORD PTR [ecx+24], eax

; 188  : }

  00015	5d		 pop	 ebp
  00016	c2 04 00	 ret	 4
?SetCenterPosition@CTerrainPatchProxy@@QAEXABUD3DXVECTOR3@@@Z ENDP ; CTerrainPatchProxy::SetCenterPosition
_TEXT	ENDS
; Function compile flags: /Ogtp
; File C:\DS Project\DS Files\Source\ClientSource\Client\GameLib\TerrainPatch.cpp
;	COMDAT ?Clear@CTerrainPatchProxy@@QAEXXZ
_TEXT	SEGMENT
?Clear@CTerrainPatchProxy@@QAEXXZ PROC			; CTerrainPatchProxy::Clear, COMDAT
; _this$ = ecx

; 235  : 	m_bUsed = false;
; 236  : 	m_sPatchNum = 0;

  00000	33 c0		 xor	 eax, eax
  00002	c6 41 04 00	 mov	 BYTE PTR [ecx+4], 0
  00006	66 89 41 06	 mov	 WORD PTR [ecx+6], ax

; 237  : 	m_byTerrainNum = 0xFF;

  0000a	c6 41 08 ff	 mov	 BYTE PTR [ecx+8], 255	; 000000ffH

; 238  : 
; 239  : 	m_pTerrainPatch = NULL;

  0000e	89 41 0c	 mov	 DWORD PTR [ecx+12], eax

; 240  : }

  00011	c3		 ret	 0
?Clear@CTerrainPatchProxy@@QAEXXZ ENDP			; CTerrainPatchProxy::Clear
_TEXT	ENDS
; Function compile flags: /Ogtp
; File C:\DS Project\DS Files\Source\ClientSource\Client\GameLib\TerrainPatch.cpp
;	COMDAT ??1CTerrainPatchProxy@@UAE@XZ
_TEXT	SEGMENT
??1CTerrainPatchProxy@@UAE@XZ PROC			; CTerrainPatchProxy::~CTerrainPatchProxy, COMDAT
; _this$ = ecx

; 181  : {

  00000	c7 01 00 00 00
	00		 mov	 DWORD PTR [ecx], OFFSET ??_7CTerrainPatchProxy@@6B@

; 182  : 	Clear();

  00006	e9 00 00 00 00	 jmp	 ?Clear@CTerrainPatchProxy@@QAEXXZ ; CTerrainPatchProxy::Clear
??1CTerrainPatchProxy@@UAE@XZ ENDP			; CTerrainPatchProxy::~CTerrainPatchProxy
_TEXT	ENDS
; Function compile flags: /Ogtp
; File C:\DS Project\DS Files\Source\ClientSource\Client\GameLib\TerrainPatch.cpp
;	COMDAT ??0CTerrainPatchProxy@@QAE@XZ
_TEXT	SEGMENT
??0CTerrainPatchProxy@@QAE@XZ PROC			; CTerrainPatchProxy::CTerrainPatchProxy, COMDAT
; _this$ = ecx

; 176  : {

  00000	56		 push	 esi
  00001	8b f1		 mov	 esi, ecx
  00003	c7 06 00 00 00
	00		 mov	 DWORD PTR [esi], OFFSET ??_7CTerrainPatchProxy@@6B@

; 177  : 	Clear();

  00009	e8 00 00 00 00	 call	 ?Clear@CTerrainPatchProxy@@QAEXXZ ; CTerrainPatchProxy::Clear

; 178  : }

  0000e	8b c6		 mov	 eax, esi
  00010	5e		 pop	 esi
  00011	c3		 ret	 0
??0CTerrainPatchProxy@@QAE@XZ ENDP			; CTerrainPatchProxy::CTerrainPatchProxy
_TEXT	ENDS
; Function compile flags: /Ogtp
; File C:\DS Project\DS Files\Source\ClientSource\Client\GameLib\TerrainPatch.cpp
;	COMDAT ?__Initialize@SSoftwareTransformPatch@CTerrainPatch@@QAEXXZ
_TEXT	SEGMENT
?__Initialize@SSoftwareTransformPatch@CTerrainPatch@@QAEXXZ PROC ; CTerrainPatch::SSoftwareTransformPatch::__Initialize, COMDAT
; _this$ = ecx

; 38   : 	m_akTerrainVertex=NULL;

  00000	c7 01 00 00 00
	00		 mov	 DWORD PTR [ecx], 0

; 39   : }

  00006	c3		 ret	 0
?__Initialize@SSoftwareTransformPatch@CTerrainPatch@@QAEXXZ ENDP ; CTerrainPatch::SSoftwareTransformPatch::__Initialize
_TEXT	ENDS
; Function compile flags: /Ogtp
; File C:\DS Project\DS Files\Source\ClientSource\Client\GameLib\TerrainPatch.cpp
;	COMDAT ?Destroy@SSoftwareTransformPatch@CTerrainPatch@@QAEXXZ
_TEXT	SEGMENT
?Destroy@SSoftwareTransformPatch@CTerrainPatch@@QAEXXZ PROC ; CTerrainPatch::SSoftwareTransformPatch::Destroy, COMDAT
; _this$ = ecx

; 29   : {

  00000	56		 push	 esi
  00001	8b f1		 mov	 esi, ecx

; 30   : 	if (m_akTerrainVertex)

  00003	8b 06		 mov	 eax, DWORD PTR [esi]
  00005	85 c0		 test	 eax, eax
  00007	74 09		 je	 SHORT $LN2@Destroy

; 31   : 		delete [] m_akTerrainVertex;

  00009	50		 push	 eax
  0000a	e8 00 00 00 00	 call	 ??_V@YAXPAX@Z		; operator delete[]
  0000f	83 c4 04	 add	 esp, 4
$LN2@Destroy:

; 32   : 
; 33   : 	__Initialize();

  00012	8b ce		 mov	 ecx, esi
  00014	5e		 pop	 esi
  00015	e9 00 00 00 00	 jmp	 ?__Initialize@SSoftwareTransformPatch@CTerrainPatch@@QAEXXZ ; CTerrainPatch::SSoftwareTransformPatch::__Initialize
?Destroy@SSoftwareTransformPatch@CTerrainPatch@@QAEXXZ ENDP ; CTerrainPatch::SSoftwareTransformPatch::Destroy
_TEXT	ENDS
; Function compile flags: /Ogtp
; File C:\DS Project\DS Files\Source\ClientSource\Client\GameLib\TerrainPatch.cpp
;	COMDAT ?Create@SSoftwareTransformPatch@CTerrainPatch@@QAEXXZ
_TEXT	SEGMENT
$T1 = -4						; size = 4
?Create@SSoftwareTransformPatch@CTerrainPatch@@QAEXXZ PROC ; CTerrainPatch::SSoftwareTransformPatch::Create, COMDAT
; _this$ = ecx

; 23   : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	51		 push	 ecx
  00004	56		 push	 esi

; 24   : 	assert(NULL==m_akTerrainVertex);
; 25   : 	m_akTerrainVertex=new SoftwareTransformPatch_SSourceVertex[TERRAIN_VERTEX_COUNT];

  00005	68 9c 1f 00 00	 push	 8092			; 00001f9cH
  0000a	8b f1		 mov	 esi, ecx
  0000c	e8 00 00 00 00	 call	 ??_U@YAPAXI@Z		; operator new[]
  00011	83 c4 04	 add	 esp, 4
  00014	89 06		 mov	 DWORD PTR [esi], eax
  00016	89 45 fc	 mov	 DWORD PTR $T1[ebp], eax
  00019	5e		 pop	 esi

; 26   : }

  0001a	8b e5		 mov	 esp, ebp
  0001c	5d		 pop	 ebp
  0001d	c3		 ret	 0
?Create@SSoftwareTransformPatch@CTerrainPatch@@QAEXXZ ENDP ; CTerrainPatch::SSoftwareTransformPatch::Create
_TEXT	ENDS
; Function compile flags: /Ogtp
; File C:\DS Project\DS Files\Source\ClientSource\Client\GameLib\TerrainPatch.cpp
;	COMDAT ??1SSoftwareTransformPatch@CTerrainPatch@@QAE@XZ
_TEXT	SEGMENT
??1SSoftwareTransformPatch@CTerrainPatch@@QAE@XZ PROC	; CTerrainPatch::SSoftwareTransformPatch::~SSoftwareTransformPatch, COMDAT
; _this$ = ecx

; 19   : 	Destroy();

  00000	e9 00 00 00 00	 jmp	 ?Destroy@SSoftwareTransformPatch@CTerrainPatch@@QAEXXZ ; CTerrainPatch::SSoftwareTransformPatch::Destroy
??1SSoftwareTransformPatch@CTerrainPatch@@QAE@XZ ENDP	; CTerrainPatch::SSoftwareTransformPatch::~SSoftwareTransformPatch
_TEXT	ENDS
; Function compile flags: /Ogtp
; File C:\DS Project\DS Files\Source\ClientSource\Client\GameLib\TerrainPatch.cpp
;	COMDAT ??0SSoftwareTransformPatch@CTerrainPatch@@QAE@XZ
_TEXT	SEGMENT
??0SSoftwareTransformPatch@CTerrainPatch@@QAE@XZ PROC	; CTerrainPatch::SSoftwareTransformPatch::SSoftwareTransformPatch, COMDAT
; _this$ = ecx

; 13   : {

  00000	56		 push	 esi
  00001	8b f1		 mov	 esi, ecx

; 14   : 	__Initialize();

  00003	e8 00 00 00 00	 call	 ?__Initialize@SSoftwareTransformPatch@CTerrainPatch@@QAEXXZ ; CTerrainPatch::SSoftwareTransformPatch::__Initialize

; 15   : }

  00008	8b c6		 mov	 eax, esi
  0000a	5e		 pop	 esi
  0000b	c3		 ret	 0
??0SSoftwareTransformPatch@CTerrainPatch@@QAE@XZ ENDP	; CTerrainPatch::SSoftwareTransformPatch::SSoftwareTransformPatch
_TEXT	ENDS
; Function compile flags: /Ogtp
; File C:\DS Project\DS Files\Source\ClientSource\Client\GameLib\TerrainPatch.cpp
;	COMDAT ?__BuildSoftwareTerrainVertexBuffer@CTerrainPatch@@IAEXPAUHardwareTransformPatch_SSourceVertex@@@Z
_TEXT	SEGMENT
_akSrcVertex$ = 8					; size = 4
?__BuildSoftwareTerrainVertexBuffer@CTerrainPatch@@IAEXPAUHardwareTransformPatch_SSourceVertex@@@Z PROC ; CTerrainPatch::__BuildSoftwareTerrainVertexBuffer, COMDAT
; _this$ = ecx

; 90   : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	56		 push	 esi

; 91   : 	//DWORD dwVBSize=sizeof(HardwareTransformPatch_SSourceVertex)*TERRAIN_VERTEX_COUNT;
; 92   : 
; 93   : 	m_kST.Create();

  00004	8d 71 6c	 lea	 esi, DWORD PTR [ecx+108]
  00007	8b ce		 mov	 ecx, esi
  00009	e8 00 00 00 00	 call	 ?Create@SSoftwareTransformPatch@CTerrainPatch@@QAEXXZ ; CTerrainPatch::SSoftwareTransformPatch::Create

; 94   : 
; 95   : 	SoftwareTransformPatch_SSourceVertex* akDstVertex=SoftwareTransformPatch_GetTerrainVertexDataPtr();

  0000e	8b 06		 mov	 eax, DWORD PTR [esi]
  00010	ba 21 01 00 00	 mov	 edx, 289		; 00000121H
  00015	8b 4d 08	 mov	 ecx, DWORD PTR _akSrcVertex$[ebp]
  00018	5e		 pop	 esi
  00019	0f 1f 80 00 00
	00 00		 npad	 7
$LL4@BuildSoftw:

; 96   : 	for (UINT uIndex=0; uIndex!=TERRAIN_VERTEX_COUNT; ++uIndex)

  00020	8d 49 18	 lea	 ecx, DWORD PTR [ecx+24]
  00023	8d 40 1c	 lea	 eax, DWORD PTR [eax+28]

; 97   : 	{
; 98   : 		*((HardwareTransformPatch_SSourceVertex*)(akDstVertex+uIndex))=*(akSrcVertex+uIndex);

  00026	0f 10 41 e8	 movups	 xmm0, XMMWORD PTR [ecx-24]
  0002a	0f 11 40 e4	 movups	 XMMWORD PTR [eax-28], xmm0
  0002e	f3 0f 7e 41 f8	 movq	 xmm0, QWORD PTR [ecx-8]
  00033	66 0f d6 40 f4	 movq	 QWORD PTR [eax-12], xmm0

; 99   : 		akDstVertex[uIndex].dwDiffuse=0xFFFFFFFF;

  00038	c7 40 fc ff ff
	ff ff		 mov	 DWORD PTR [eax-4], -1
  0003f	83 ea 01	 sub	 edx, 1
  00042	75 dc		 jne	 SHORT $LL4@BuildSoftw

; 100  : 	}
; 101  : }

  00044	5d		 pop	 ebp
  00045	c2 04 00	 ret	 4
?__BuildSoftwareTerrainVertexBuffer@CTerrainPatch@@IAEXPAUHardwareTransformPatch_SSourceVertex@@@Z ENDP ; CTerrainPatch::__BuildSoftwareTerrainVertexBuffer
_TEXT	ENDS
; Function compile flags: /Ogtp
; File C:\DS Project\DS Files\Source\ClientSource\Client\GameLib\TerrainPatch.cpp
;	COMDAT ?__BuildHardwareTerrainVertexBuffer@CTerrainPatch@@IAEXPAUHardwareTransformPatch_SSourceVertex@@@Z
_TEXT	SEGMENT
_akDstVertex$ = -4					; size = 4
_akSrcVertex$ = 8					; size = 4
?__BuildHardwareTerrainVertexBuffer@CTerrainPatch@@IAEXPAUHardwareTransformPatch_SSourceVertex@@@Z PROC ; CTerrainPatch::__BuildHardwareTerrainVertexBuffer, COMDAT
; _this$ = ecx

; 104  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	51		 push	 ecx

; 105  : 
; 106  : 	CGraphicVertexBuffer& rkVB=m_kHT.m_kVB;
; 107  : 	if (!rkVB.Create(TERRAIN_VERTEX_COUNT, D3DFVF_XYZ | D3DFVF_NORMAL, D3DUSAGE_WRITEONLY, D3DPOOL_MANAGED))

  00004	8b 41 4c	 mov	 eax, DWORD PTR [ecx+76]
  00007	56		 push	 esi
  00008	8d 71 4c	 lea	 esi, DWORD PTR [ecx+76]
  0000b	6a 01		 push	 1
  0000d	8b 40 04	 mov	 eax, DWORD PTR [eax+4]
  00010	8b ce		 mov	 ecx, esi
  00012	6a 08		 push	 8
  00014	6a 12		 push	 18			; 00000012H
  00016	68 21 01 00 00	 push	 289			; 00000121H
  0001b	ff d0		 call	 eax
  0001d	84 c0		 test	 al, al
  0001f	74 2b		 je	 SHORT $LN3@BuildHardw

; 108  : 		return;
; 109  : 
; 110  : 	HardwareTransformPatch_SSourceVertex* akDstVertex;
; 111  : 	if (rkVB.Lock((void **) &akDstVertex))

  00021	8b 06		 mov	 eax, DWORD PTR [esi]
  00023	8d 4d fc	 lea	 ecx, DWORD PTR _akDstVertex$[ebp]
  00026	51		 push	 ecx
  00027	8b ce		 mov	 ecx, esi
  00029	8b 40 08	 mov	 eax, DWORD PTR [eax+8]
  0002c	ff d0		 call	 eax
  0002e	84 c0		 test	 al, al
  00030	74 1a		 je	 SHORT $LN3@BuildHardw

; 112  : 	{
; 113  : 		UINT uVBSize=sizeof(HardwareTransformPatch_SSourceVertex)*TERRAIN_VERTEX_COUNT;
; 114  : 
; 115  : 		memcpy(akDstVertex, akSrcVertex, uVBSize);

  00032	68 18 1b 00 00	 push	 6936			; 00001b18H
  00037	ff 75 08	 push	 DWORD PTR _akSrcVertex$[ebp]
  0003a	ff 75 fc	 push	 DWORD PTR _akDstVertex$[ebp]
  0003d	e8 00 00 00 00	 call	 _memcpy
  00042	83 c4 0c	 add	 esp, 12			; 0000000cH

; 116  : 		rkVB.Unlock();

  00045	8b ce		 mov	 ecx, esi
  00047	e8 00 00 00 00	 call	 ?Unlock@CGraphicVertexBuffer@@QAE_NXZ ; CGraphicVertexBuffer::Unlock
$LN3@BuildHardw:
  0004c	5e		 pop	 esi

; 117  : 	}
; 118  : }

  0004d	8b e5		 mov	 esp, ebp
  0004f	5d		 pop	 ebp
  00050	c2 04 00	 ret	 4
?__BuildHardwareTerrainVertexBuffer@CTerrainPatch@@IAEXPAUHardwareTransformPatch_SSourceVertex@@@Z ENDP ; CTerrainPatch::__BuildHardwareTerrainVertexBuffer
_TEXT	ENDS
; Function compile flags: /Ogtp
; File C:\DS Project\DS Files\Source\ClientSource\Client\GameLib\TerrainPatch.cpp
;	COMDAT ?BuildWaterVertexBuffer@CTerrainPatch@@QAEXPAUSWaterVertex@@I@Z
_TEXT	SEGMENT
_akSrcVertex$ = 8					; size = 4
_akDstWaterVertex$ = 12					; size = 4
_uWaterVertexCount$ = 12				; size = 4
?BuildWaterVertexBuffer@CTerrainPatch@@QAEXPAUSWaterVertex@@I@Z PROC ; CTerrainPatch::BuildWaterVertexBuffer, COMDAT
; _this$ = ecx

; 64   : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	53		 push	 ebx
  00004	56		 push	 esi
  00005	57		 push	 edi

; 65   : 	CGraphicVertexBuffer& rkVB=m_WaterVertexBuffer;
; 66   : 
; 67   : 	if (!rkVB.Create(uWaterVertexCount, D3DFVF_XYZ | D3DFVF_DIFFUSE, D3DUSAGE_WRITEONLY, D3DPOOL_MANAGED))

  00006	8b 7d 0c	 mov	 edi, DWORD PTR _uWaterVertexCount$[ebp]
  00009	8b d9		 mov	 ebx, ecx
  0000b	6a 01		 push	 1
  0000d	6a 08		 push	 8
  0000f	6a 42		 push	 66			; 00000042H
  00011	8b 43 24	 mov	 eax, DWORD PTR [ebx+36]
  00014	8d 4b 24	 lea	 ecx, DWORD PTR [ebx+36]
  00017	57		 push	 edi
  00018	8b 40 04	 mov	 eax, DWORD PTR [eax+4]
  0001b	ff d0		 call	 eax
  0001d	84 c0		 test	 al, al
  0001f	74 3b		 je	 SHORT $LN3@BuildWater

; 68   : 		return;
; 69   : 
; 70   : 	SWaterVertex* akDstWaterVertex;
; 71   : 	if (rkVB.Lock((void **) &akDstWaterVertex))

  00021	8b 43 24	 mov	 eax, DWORD PTR [ebx+36]
  00024	8d 4d 0c	 lea	 ecx, DWORD PTR _akDstWaterVertex$[ebp]
  00027	51		 push	 ecx
  00028	8d 4b 24	 lea	 ecx, DWORD PTR [ebx+36]
  0002b	8b 40 08	 mov	 eax, DWORD PTR [eax+8]
  0002e	ff d0		 call	 eax
  00030	84 c0		 test	 al, al
  00032	74 28		 je	 SHORT $LN3@BuildWater

; 72   : 	{
; 73   : 		UINT uVBSize=sizeof(SWaterVertex)*uWaterVertexCount;

  00034	8b c7		 mov	 eax, edi
  00036	c1 e0 04	 shl	 eax, 4

; 74   : 		memcpy(akDstWaterVertex, akSrcVertex, uVBSize);

  00039	50		 push	 eax
  0003a	ff 75 08	 push	 DWORD PTR _akSrcVertex$[ebp]
  0003d	ff 75 0c	 push	 DWORD PTR _akDstWaterVertex$[ebp]
  00040	e8 00 00 00 00	 call	 _memcpy

; 75   : 		m_dwWaterPriCount=uWaterVertexCount/3;

  00045	b8 ab aa aa aa	 mov	 eax, -1431655765	; aaaaaaabH

; 76   : 
; 77   : 		rkVB.Unlock();

  0004a	8d 4b 24	 lea	 ecx, DWORD PTR [ebx+36]
  0004d	f7 e7		 mul	 edi
  0004f	83 c4 0c	 add	 esp, 12			; 0000000cH
  00052	d1 ea		 shr	 edx, 1
  00054	89 53 20	 mov	 DWORD PTR [ebx+32], edx
  00057	e8 00 00 00 00	 call	 ?Unlock@CGraphicVertexBuffer@@QAE_NXZ ; CGraphicVertexBuffer::Unlock
$LN3@BuildWater:

; 78   : 	}
; 79   : }

  0005c	5f		 pop	 edi
  0005d	5e		 pop	 esi
  0005e	5b		 pop	 ebx
  0005f	5d		 pop	 ebp
  00060	c2 08 00	 ret	 8
?BuildWaterVertexBuffer@CTerrainPatch@@QAEXPAUSWaterVertex@@I@Z ENDP ; CTerrainPatch::BuildWaterVertexBuffer
_TEXT	ENDS
; Function compile flags: /Ogtp
; File C:\DS Project\DS Files\Source\ClientSource\Client\GameLib\TerrainPatch.cpp
;	COMDAT ?BuildTerrainVertexBuffer@CTerrainPatch@@QAEXPAUHardwareTransformPatch_SSourceVertex@@@Z
_TEXT	SEGMENT
_akSrcVertex$ = 8					; size = 4
?BuildTerrainVertexBuffer@CTerrainPatch@@QAEXPAUHardwareTransformPatch_SSourceVertex@@@Z PROC ; CTerrainPatch::BuildTerrainVertexBuffer, COMDAT
; _this$ = ecx

; 82   : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp

; 83   : 	if (SOFTWARE_TRANSFORM_PATCH_ENABLE)

  00003	80 3d 00 00 00
	00 00		 cmp	 BYTE PTR ?SOFTWARE_TRANSFORM_PATCH_ENABLE@CTerrainPatch@@2_NA, 0 ; CTerrainPatch::SOFTWARE_TRANSFORM_PATCH_ENABLE
  0000a	74 06		 je	 SHORT $LN2@BuildTerra

; 87   : }

  0000c	5d		 pop	 ebp

; 84   : 		__BuildSoftwareTerrainVertexBuffer(akSrcVertex);

  0000d	e9 00 00 00 00	 jmp	 ?__BuildSoftwareTerrainVertexBuffer@CTerrainPatch@@IAEXPAUHardwareTransformPatch_SSourceVertex@@@Z ; CTerrainPatch::__BuildSoftwareTerrainVertexBuffer
$LN2@BuildTerra:

; 87   : }

  00012	5d		 pop	 ebp

; 85   : 	else
; 86   : 		__BuildHardwareTerrainVertexBuffer(akSrcVertex);

  00013	e9 00 00 00 00	 jmp	 ?__BuildHardwareTerrainVertexBuffer@CTerrainPatch@@IAEXPAUHardwareTransformPatch_SSourceVertex@@@Z ; CTerrainPatch::__BuildHardwareTerrainVertexBuffer
?BuildTerrainVertexBuffer@CTerrainPatch@@QAEXPAUHardwareTransformPatch_SSourceVertex@@@Z ENDP ; CTerrainPatch::BuildTerrainVertexBuffer
_TEXT	ENDS
; Function compile flags: /Ogtp
; File C:\DS Project\DS Files\Source\ClientSource\Client\GameLib\TerrainPatch.cpp
; File C:\DS Project\DS Files\Source\ClientSource\extern\include\d3dx8math.inl
; File C:\DS Project\DS Files\Source\ClientSource\Client\GameLib\TerrainPatch.cpp
; File C:\DS Project\DS Files\Source\ClientSource\extern\include\d3dx8math.inl
; File C:\DS Project\DS Files\Source\ClientSource\Client\GameLib\TerrainPatch.cpp
; File C:\DS Project\DS Files\Source\ClientSource\extern\include\d3dx8math.inl
; File C:\DS Project\DS Files\Source\ClientSource\Client\GameLib\TerrainPatch.cpp
;	COMDAT ?SoftwareTransformPatch_UpdateTerrainLighting@CTerrainPatch@@QAEXKABU_D3DLIGHT8@@ABU_D3DMATERIAL8@@@Z
_TEXT	SEGMENT
tv658 = -28						; size = 4
_kLightDir$$sroa$315$1$ = -24				; size = 4
_kLightDir$$sroa$163$1$ = -20				; size = 4
_kLightDir$$sroa$318$1$ = -16				; size = 4
_akSrcVertex$1$ = -12					; size = 4
_dwAmbientB$1$ = -8					; size = 4
_dwAmbientG$1$ = -4					; size = 4
_dwAmbientR$1$ = 8					; size = 4
_dwVersion$ = 8						; size = 4
tv659 = 12						; size = 4
_c_rkLight$ = 12					; size = 4
tv660 = 16						; size = 4
_c_rkMtrl$ = 16						; size = 4
?SoftwareTransformPatch_UpdateTerrainLighting@CTerrainPatch@@QAEXKABU_D3DLIGHT8@@ABU_D3DMATERIAL8@@@Z PROC ; CTerrainPatch::SoftwareTransformPatch_UpdateTerrainLighting, COMDAT
; _this$ = ecx

; 121  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp

; 122  : 	if (m_dwVersion==dwVersion)

  00003	8b 45 08	 mov	 eax, DWORD PTR _dwVersion$[ebp]
  00006	83 ec 1c	 sub	 esp, 28			; 0000001cH
  00009	39 41 48	 cmp	 DWORD PTR [ecx+72], eax
  0000c	0f 84 cb 01 00
	00		 je	 $LN3@SoftwareTr

; 123  : 		return;
; 124  : 
; 125  : 	m_dwVersion=dwVersion;

  00012	89 41 48	 mov	 DWORD PTR [ecx+72], eax

; 126  : 
; 127  : 	SoftwareTransformPatch_SSourceVertex* akSrcVertex=SoftwareTransformPatch_GetTerrainVertexDataPtr();

  00015	8b 41 6c	 mov	 eax, DWORD PTR [ecx+108]
  00018	89 45 f4	 mov	 DWORD PTR _akSrcVertex$1$[ebp], eax

; 128  : 	if (!akSrcVertex)

  0001b	85 c0		 test	 eax, eax
  0001d	0f 84 ba 01 00
	00		 je	 $LN3@SoftwareTr
; File C:\DS Project\DS Files\Source\ClientSource\extern\include\d3dx8math.inl

; 172  :     x = v.x;

  00023	56		 push	 esi
  00024	8b 75 0c	 mov	 esi, DWORD PTR _c_rkLight$[ebp]
  00027	57		 push	 edi
; File C:\DS Project\DS Files\Source\ClientSource\Client\GameLib\TerrainPatch.cpp

; 135  : 	DWORD dwAmbientR=(c_rkMtrl.Ambient.r*c_rkLight.Ambient.r+c_rkMtrl.Emissive.r)*255.0f;

  00028	8b 7d 10	 mov	 edi, DWORD PTR _c_rkMtrl$[ebp]
; File C:\DS Project\DS Files\Source\ClientSource\extern\include\d3dx8math.inl

; 172  :     x = v.x;

  0002b	f3 0f 10 46 40	 movss	 xmm0, DWORD PTR [esi+64]
  00030	f3 0f 11 45 ec	 movss	 DWORD PTR _kLightDir$$sroa$163$1$[ebp], xmm0

; 173  :     y = v.y;

  00035	f3 0f 10 46 44	 movss	 xmm0, DWORD PTR [esi+68]
  0003a	f3 0f 11 45 f0	 movss	 DWORD PTR _kLightDir$$sroa$318$1$[ebp], xmm0

; 174  :     z = v.z;

  0003f	f3 0f 10 46 48	 movss	 xmm0, DWORD PTR [esi+72]
  00044	f3 0f 11 45 e8	 movss	 DWORD PTR _kLightDir$$sroa$315$1$[ebp], xmm0
; File C:\DS Project\DS Files\Source\ClientSource\Client\GameLib\TerrainPatch.cpp

; 135  : 	DWORD dwAmbientR=(c_rkMtrl.Ambient.r*c_rkLight.Ambient.r+c_rkMtrl.Emissive.r)*255.0f;

  00049	f3 0f 10 46 24	 movss	 xmm0, DWORD PTR [esi+36]
  0004e	f3 0f 59 47 10	 mulss	 xmm0, DWORD PTR [edi+16]
  00053	f3 0f 58 47 30	 addss	 xmm0, DWORD PTR [edi+48]
  00058	f3 0f 59 05 00
	00 00 00	 mulss	 xmm0, DWORD PTR __real@437f0000
  00060	e8 00 00 00 00	 call	 __ftoui3

; 136  : 	DWORD dwAmbientG=(c_rkMtrl.Ambient.g*c_rkLight.Ambient.g+c_rkMtrl.Emissive.g)*255.0f;

  00065	f3 0f 10 46 28	 movss	 xmm0, DWORD PTR [esi+40]
  0006a	f3 0f 59 47 14	 mulss	 xmm0, DWORD PTR [edi+20]
  0006f	89 45 08	 mov	 DWORD PTR _dwAmbientR$1$[ebp], eax
  00072	f3 0f 58 47 34	 addss	 xmm0, DWORD PTR [edi+52]
  00077	f3 0f 59 05 00
	00 00 00	 mulss	 xmm0, DWORD PTR __real@437f0000
  0007f	e8 00 00 00 00	 call	 __ftoui3

; 137  : 	DWORD dwAmbientB=(c_rkMtrl.Ambient.b*c_rkLight.Ambient.b+c_rkMtrl.Emissive.b)*255.0f;

  00084	f3 0f 10 46 2c	 movss	 xmm0, DWORD PTR [esi+44]
  00089	f3 0f 59 47 18	 mulss	 xmm0, DWORD PTR [edi+24]
  0008e	89 45 fc	 mov	 DWORD PTR _dwAmbientG$1$[ebp], eax
  00091	f3 0f 58 47 38	 addss	 xmm0, DWORD PTR [edi+56]
  00096	f3 0f 59 05 00
	00 00 00	 mulss	 xmm0, DWORD PTR __real@437f0000
  0009e	e8 00 00 00 00	 call	 __ftoui3

; 138  : 	DWORD dwDiffuseR=(c_rkMtrl.Diffuse.r*c_rkLight.Diffuse.r)*255.0f;

  000a3	f3 0f 10 46 04	 movss	 xmm0, DWORD PTR [esi+4]
  000a8	f3 0f 59 07	 mulss	 xmm0, DWORD PTR [edi]
  000ac	89 45 f8	 mov	 DWORD PTR _dwAmbientB$1$[ebp], eax
  000af	f3 0f 59 05 00
	00 00 00	 mulss	 xmm0, DWORD PTR __real@437f0000
  000b7	e8 00 00 00 00	 call	 __ftoui3

; 139  : 	DWORD dwDiffuseG=(c_rkMtrl.Diffuse.g*c_rkLight.Diffuse.g)*255.0f;

  000bc	8b 4d 0c	 mov	 ecx, DWORD PTR _c_rkLight$[ebp]
  000bf	8b f0		 mov	 esi, eax
  000c1	f3 0f 10 41 08	 movss	 xmm0, DWORD PTR [ecx+8]
  000c6	f3 0f 59 47 04	 mulss	 xmm0, DWORD PTR [edi+4]
  000cb	f3 0f 59 05 00
	00 00 00	 mulss	 xmm0, DWORD PTR __real@437f0000
  000d3	e8 00 00 00 00	 call	 __ftoui3
  000d8	8b f8		 mov	 edi, eax

; 140  : 	DWORD dwDiffuseB=(c_rkMtrl.Diffuse.b*c_rkLight.Diffuse.b)*255.0f;

  000da	8b 45 0c	 mov	 eax, DWORD PTR _c_rkLight$[ebp]
  000dd	f3 0f 10 40 0c	 movss	 xmm0, DWORD PTR [eax+12]
  000e2	8b 45 10	 mov	 eax, DWORD PTR _c_rkMtrl$[ebp]
  000e5	f3 0f 59 40 08	 mulss	 xmm0, DWORD PTR [eax+8]
  000ea	f3 0f 59 05 00
	00 00 00	 mulss	 xmm0, DWORD PTR __real@437f0000
  000f2	e8 00 00 00 00	 call	 __ftoui3
  000f7	8b d0		 mov	 edx, eax
  000f9	b8 ff 00 00 00	 mov	 eax, 255		; 000000ffH
  000fe	2b 45 08	 sub	 eax, DWORD PTR _dwAmbientR$1$[ebp]

; 141  : 
; 142  : 	if (dwDiffuseR>255-dwAmbientR)
; 143  : 		dwDiffuseR=255-dwAmbientR;
; 144  : 
; 145  : 	if (dwDiffuseG+dwAmbientG>255)

  00101	3b f0		 cmp	 esi, eax
  00103	0f 46 c6	 cmovbe	 eax, esi

; 146  : 		dwDiffuseG=255-dwAmbientG;
; 147  : 
; 148  : 	if (dwDiffuseB+dwAmbientB>255)

  00106	be ff 00 00 00	 mov	 esi, 255		; 000000ffH
  0010b	89 45 10	 mov	 DWORD PTR tv660[ebp], eax
  0010e	8b 45 fc	 mov	 eax, DWORD PTR _dwAmbientG$1$[ebp]
  00111	89 75 0c	 mov	 DWORD PTR tv659[ebp], esi
  00114	29 45 0c	 sub	 DWORD PTR tv659[ebp], eax
  00117	8d 0c 07	 lea	 ecx, DWORD PTR [edi+eax]
  0011a	8b 45 0c	 mov	 eax, DWORD PTR tv659[ebp]
  0011d	3b ce		 cmp	 ecx, esi
  0011f	8b 4d f8	 mov	 ecx, DWORD PTR _dwAmbientB$1$[ebp]
  00122	0f 46 c7	 cmovbe	 eax, edi

; 149  : 		dwDiffuseB=255-dwAmbientB;
; 150  : 
; 151  : 	for (UINT uIndex=0; uIndex!=CTerrainPatch::TERRAIN_VERTEX_COUNT; ++uIndex)

  00125	2b f1		 sub	 esi, ecx
  00127	89 45 0c	 mov	 DWORD PTR tv659[ebp], eax
  0012a	bf 21 01 00 00	 mov	 edi, 289		; 00000121H
  0012f	8d 04 0a	 lea	 eax, DWORD PTR [edx+ecx]
  00132	3d ff 00 00 00	 cmp	 eax, 255		; 000000ffH
  00137	0f 46 f2	 cmovbe	 esi, edx
  0013a	c1 65 fc 08	 shl	 DWORD PTR _dwAmbientG$1$[ebp], 8
  0013e	c1 65 08 10	 shl	 DWORD PTR _dwAmbientR$1$[ebp], 16 ; 00000010H
  00142	89 75 e4	 mov	 DWORD PTR tv658[ebp], esi
  00145	8b 75 f4	 mov	 esi, DWORD PTR _akSrcVertex$1$[ebp]
  00148	83 c6 14	 add	 esi, 20			; 00000014H
  0014b	0f 1f 44 00 00	 npad	 5
$LL4@SoftwareTr:
; File C:\DS Project\DS Files\Source\ClientSource\extern\include\d3dx8math.inl

; 1264 :     return pV1->x * pV2->x + pV1->y * pV2->y + pV1->z * pV2->z;

  00150	f3 0f 10 46 f8	 movss	 xmm0, DWORD PTR [esi-8]
  00155	f3 0f 59 45 ec	 mulss	 xmm0, DWORD PTR _kLightDir$$sroa$163$1$[ebp]
  0015a	f3 0f 10 4e fc	 movss	 xmm1, DWORD PTR [esi-4]
  0015f	f3 0f 59 4d f0	 mulss	 xmm1, DWORD PTR _kLightDir$$sroa$318$1$[ebp]
  00164	f3 0f 58 c8	 addss	 xmm1, xmm0
  00168	f3 0f 10 45 e8	 movss	 xmm0, DWORD PTR _kLightDir$$sroa$315$1$[ebp]
  0016d	f3 0f 59 06	 mulss	 xmm0, DWORD PTR [esi]
  00171	f3 0f 58 c8	 addss	 xmm1, xmm0
  00175	0f 57 c0	 xorps	 xmm0, xmm0
; File C:\DS Project\DS Files\Source\ClientSource\Client\GameLib\TerrainPatch.cpp

; 157  : 		if (fDot<0.0f)

  00178	0f 2f c1	 comiss	 xmm0, xmm1
  0017b	76 07		 jbe	 SHORT $LN10@SoftwareTr

; 158  : 			dwDot=(N*-fDot);

  0017d	0f 57 0d 00 00
	00 00		 xorps	 xmm1, DWORD PTR __xmm@80000000800000008000000080000000
$LN10@SoftwareTr:

; 159  : 		else
; 160  : 			dwDot=(N*+fDot);
; 161  : 
; 162  : 		akSrcVertex[uIndex].dwDiffuse=(0xff000000)|

  00184	f3 0f 59 0d 00
	00 00 00	 mulss	 xmm1, DWORD PTR __real@4b7fffff
  0018c	0f 28 c1	 movaps	 xmm0, xmm1
  0018f	e8 00 00 00 00	 call	 __ftoui3
  00194	8b d0		 mov	 edx, eax
  00196	8b c8		 mov	 ecx, eax
  00198	0f af 55 10	 imul	 edx, DWORD PTR tv660[ebp]
  0019c	0f af 4d 0c	 imul	 ecx, DWORD PTR tv659[ebp]
  001a0	0f af 45 e4	 imul	 eax, DWORD PTR tv658[ebp]
  001a4	c1 ea 08	 shr	 edx, 8
  001a7	81 e2 00 00 ff
	ff		 and	 edx, -65536		; ffff0000H
  001ad	c1 e9 10	 shr	 ecx, 16			; 00000010H
  001b0	03 55 08	 add	 edx, DWORD PTR _dwAmbientR$1$[ebp]
  001b3	81 e1 00 ff 00
	00		 and	 ecx, 65280		; 0000ff00H
  001b9	03 4d fc	 add	 ecx, DWORD PTR _dwAmbientG$1$[ebp]
  001bc	c1 e8 18	 shr	 eax, 24			; 00000018H
  001bf	0b d1		 or	 edx, ecx
  001c1	03 45 f8	 add	 eax, DWORD PTR _dwAmbientB$1$[ebp]
  001c4	0b d0		 or	 edx, eax
  001c6	81 ca 00 00 00
	ff		 or	 edx, -16777216		; ff000000H
  001cc	89 56 04	 mov	 DWORD PTR [esi+4], edx
  001cf	83 c6 1c	 add	 esi, 28			; 0000001cH
  001d2	83 ef 01	 sub	 edi, 1
  001d5	0f 85 75 ff ff
	ff		 jne	 $LL4@SoftwareTr
  001db	5f		 pop	 edi
  001dc	5e		 pop	 esi
$LN3@SoftwareTr:

; 163  : 			(((dwDiffuseR*dwDot>>S)+dwAmbientR)<<16)|
; 164  : 			(((dwDiffuseG*dwDot>>S)+dwAmbientG)<<8)|
; 165  : 			((dwDiffuseB*dwDot>>S)+dwAmbientB);
; 166  : 	}
; 167  : 
; 168  : }

  001dd	8b e5		 mov	 esp, ebp
  001df	5d		 pop	 ebp
  001e0	c2 0c 00	 ret	 12			; 0000000cH
?SoftwareTransformPatch_UpdateTerrainLighting@CTerrainPatch@@QAEXKABU_D3DLIGHT8@@ABU_D3DMATERIAL8@@@Z ENDP ; CTerrainPatch::SoftwareTransformPatch_UpdateTerrainLighting
_TEXT	ENDS
; Function compile flags: /Ogtp
; File C:\DS Project\DS Files\Source\ClientSource\Client\GameLib\TerrainPatch.cpp
;	COMDAT ?GetWaterFaceCount@CTerrainPatch@@QAEIXZ
_TEXT	SEGMENT
?GetWaterFaceCount@CTerrainPatch@@QAEIXZ PROC		; CTerrainPatch::GetWaterFaceCount, COMDAT
; _this$ = ecx

; 172  : 	return m_dwWaterPriCount;

  00000	8b 41 20	 mov	 eax, DWORD PTR [ecx+32]

; 173  : }

  00003	c3		 ret	 0
?GetWaterFaceCount@CTerrainPatch@@QAEIXZ ENDP		; CTerrainPatch::GetWaterFaceCount
_TEXT	ENDS
; Function compile flags: /Ogtp
; File C:\DS Project\DS Files\Source\ClientSource\Client\GameLib\TerrainPatch.cpp
;	COMDAT ?Clear@CTerrainPatch@@QAEXXZ
_TEXT	SEGMENT
?Clear@CTerrainPatch@@QAEXXZ PROC			; CTerrainPatch::Clear, COMDAT
; _this$ = ecx

; 44   : {

  00000	56		 push	 esi
  00001	8b f1		 mov	 esi, ecx

; 45   : 	m_kHT.m_kVB.Destroy();

  00003	8d 4e 4c	 lea	 ecx, DWORD PTR [esi+76]
  00006	e8 00 00 00 00	 call	 ?Destroy@CGraphicVertexBuffer@@QAEXXZ ; CGraphicVertexBuffer::Destroy

; 46   : 	m_kST.Destroy();

  0000b	8d 4e 6c	 lea	 ecx, DWORD PTR [esi+108]
  0000e	e8 00 00 00 00	 call	 ?Destroy@SSoftwareTransformPatch@CTerrainPatch@@QAEXXZ ; CTerrainPatch::SSoftwareTransformPatch::Destroy

; 47   : 
; 48   : 	m_WaterVertexBuffer.Destroy();

  00013	8d 4e 24	 lea	 ecx, DWORD PTR [esi+36]
  00016	e8 00 00 00 00	 call	 ?Destroy@CGraphicVertexBuffer@@QAEXXZ ; CGraphicVertexBuffer::Destroy

; 49   : 	ClearID();

  0001b	c7 46 1c ff ff
	ff ff		 mov	 DWORD PTR [esi+28], -1

; 50   : 	SetUse(false);

  00022	66 c7 46 18 00
	00		 mov	 WORD PTR [esi+24], 0

; 51   : 
; 52   : 	m_bWaterExist = false;
; 53   : 	m_bNeedUpdate = true;
; 54   : 
; 55   : 	m_dwWaterPriCount = 0;
; 56   : 	m_byType = PATCH_TYPE_PLAIN;

  00028	66 c7 46 44 00
	01		 mov	 WORD PTR [esi+68], 256	; 00000100H
  0002e	c7 46 20 00 00
	00 00		 mov	 DWORD PTR [esi+32], 0

; 57   : 
; 58   : 	m_fMinX = m_fMaxX = m_fMinY = m_fMaxY = m_fMinZ = m_fMaxZ = 0.0f;

  00035	c7 46 14 00 00
	00 00		 mov	 DWORD PTR [esi+20], 0
  0003c	c7 46 10 00 00
	00 00		 mov	 DWORD PTR [esi+16], 0
  00043	c7 46 0c 00 00
	00 00		 mov	 DWORD PTR [esi+12], 0
  0004a	c7 46 08 00 00
	00 00		 mov	 DWORD PTR [esi+8], 0
  00051	c7 46 04 00 00
	00 00		 mov	 DWORD PTR [esi+4], 0
  00058	c7 06 00 00 00
	00		 mov	 DWORD PTR [esi], 0

; 59   : 
; 60   : 	m_dwVersion=0;

  0005e	c7 46 48 00 00
	00 00		 mov	 DWORD PTR [esi+72], 0
  00065	5e		 pop	 esi

; 61   : }

  00066	c3		 ret	 0
?Clear@CTerrainPatch@@QAEXXZ ENDP			; CTerrainPatch::Clear
_TEXT	ENDS
; Function compile flags: /Ogtp
;	COMDAT ??0SoftwareTransformPatch_SSourceVertex@@QAE@XZ
_TEXT	SEGMENT
??0SoftwareTransformPatch_SSourceVertex@@QAE@XZ PROC	; SoftwareTransformPatch_SSourceVertex::SoftwareTransformPatch_SSourceVertex, COMDAT
; _this$ = ecx
  00000	8b c1		 mov	 eax, ecx
  00002	c3		 ret	 0
??0SoftwareTransformPatch_SSourceVertex@@QAE@XZ ENDP	; SoftwareTransformPatch_SSourceVertex::SoftwareTransformPatch_SSourceVertex
_TEXT	ENDS
; Function compile flags: /Ogtp
;	COMDAT ??_H@YGXPAXIIP6EPAX0@Z@Z
_TEXT	SEGMENT
___t$ = 8						; size = 4
___s$ = 12						; size = 4
___n$ = 16						; size = 4
___f$ = 20						; size = 4
??_H@YGXPAXIIP6EPAX0@Z@Z PROC				; `vector constructor iterator', COMDAT
  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	56		 push	 esi
  00004	8b 75 10	 mov	 esi, DWORD PTR ___n$[ebp]
  00007	85 f6		 test	 esi, esi
  00009	74 16		 je	 SHORT $LN6@vector
  0000b	53		 push	 ebx
  0000c	8b 5d 14	 mov	 ebx, DWORD PTR ___f$[ebp]
  0000f	57		 push	 edi
  00010	8b 7d 08	 mov	 edi, DWORD PTR ___t$[ebp]
$LL2@vector:
  00013	8b cf		 mov	 ecx, edi
  00015	ff d3		 call	 ebx
  00017	03 7d 0c	 add	 edi, DWORD PTR ___s$[ebp]
  0001a	83 ee 01	 sub	 esi, 1
  0001d	75 f4		 jne	 SHORT $LL2@vector
  0001f	5f		 pop	 edi
  00020	5b		 pop	 ebx
$LN6@vector:
  00021	5e		 pop	 esi
  00022	5d		 pop	 ebp
  00023	c2 10 00	 ret	 16			; 00000010H
??_H@YGXPAXIIP6EPAX0@Z@Z ENDP				; `vector constructor iterator'
_TEXT	ENDS
END
